@using DotNetBlazor.Client.Utility;
@implements IDisposable
@inject IEventHelper EventHelper

<button disabled="@IsLoading" class="btn btn-@Type">
    @if (IsLoading)
    {
        <span class="spinner-border spinner-border-sm mr-1"></span>
    }
    @Text
</button>

@code {
    [Parameter]
    public string Text { get; set; } = "Submit";
    [Parameter]
    public string Type { get; set; } = "primary";

    private bool IsLoading = false;

    protected override void OnInitialized()
    {
        EventHelper.LoadingState += HandleLoader;
    }

    public void HandleLoader(bool state)
    {
        IsLoading = state;
        StateHasChanged();
    }

    public void Dispose()
    {
        EventHelper.LoadingState -= HandleLoader;
    }
}